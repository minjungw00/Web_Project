# syntax=docker/dockerfile:1.7
FROM nginx:1.29-alpine

RUN apk add --no-cache bash gettext curl

# Dev/default image uses the dev template
COPY infra/gateway/nginx/default.dev.conf /etc/nginx/templates/default.conf.template
COPY infra/gateway/nginx/proxy-headers.conf /etc/nginx/snippets/proxy-headers.conf
COPY infra/gateway/docker/nginx/entrypoint.sh /docker-entrypoint.d/99-envsubst.sh

RUN chmod +x /docker-entrypoint.d/99-envsubst.sh \
	&& mkdir -p /etc/nginx/secrets

EXPOSE 80
