# syntax=docker/dockerfile:1.7
FROM eclipse-temurin:21-jdk

ARG USER_ID=1000
ARG GROUP_ID=1000

RUN groupadd -g ${GROUP_ID} app \
  && useradd -m -u ${USER_ID} -g app app

WORKDIR /workspace

# Copy Gradle wrapper and configuration for dependency caching.
COPY backend/gradlew ./
COPY backend/gradle ./gradle
COPY backend/build.gradle backend/settings.gradle ./

RUN chmod +x gradlew \
  && mkdir -p /workspace/.gradle \
  && chown -R app:app /workspace

USER app

EXPOSE 8080

CMD ["./gradlew", "bootRun"]
